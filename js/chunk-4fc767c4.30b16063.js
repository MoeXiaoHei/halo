(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-4fc767c4"],{"05fb":function(t,e,s){},1:function(t,e){},"1bab":function(t,e,s){"use strict";s.d(e,"a",(function(){return o}));s("8237");var a=s("2b0e"),r=s("4328"),i=s.n(r);function o(t,e,s){return new Promise((r,o)=>{let n={data:JSON.stringify(e)};var l="60000";null!=s&&(l=s+"");let c=parseInt(l);t=t+"?"+(new Date).getTime()+Math.random()+Math.ceil(-89999*Math.random()+99999),a.default.prototype.$http.post(t,i.a.stringify(n),{timeout:c}).then(t=>{r(t)}).catch(t=>{o(t)})})}},2048:function(t,e,s){"use strict";var a={name:"table-expand.vue",props:{row:Object},methods:{formatBytes(t,e){if(0==t)return"0 Bytes";var s=e||2,a=Math.floor(Math.log(t)/Math.log(1024));return parseFloat((t/Math.pow(1024,a)).toFixed(s))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][a]}},computed:{getMemory:function(){return this.row.memory?this.formatBytes(1024*this.row.memory*1024,2):"0B"}}},r=(s("7130"),s("2877")),i=Object(r.a)(a,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("Row",{staticClass:"expand-row"},[s("Col",{attrs:{span:"8"}},[s("span",{staticClass:"expand-key"},[t._v("注册日期: ")]),s("span",{staticClass:"expand-value"},[t._v(t._s(t.row.birthder))])]),s("Col",{attrs:{span:"8"}},[s("span",{staticClass:"expand-key"},[t._v("用户组: ")]),s("span",{staticClass:"expand-value"},[t._v(t._s(t.row.groupname))])]),s("Col",{attrs:{span:"8"}},[s("span",{staticClass:"expand-key"},[t._v("密码: ")]),s("span",{staticClass:"expand-value"},[t._v(t._s(t.row.password))])])],1),s("Row",[s("Col",{attrs:{span:"8"}},[s("span",{staticClass:"expand-key"},[t._v("容量: ")]),s("span",{staticClass:"expand-value"},[t._v(t._s(t.getMemory))])])],1)],1)}),[],!1,null,"38b97399",null);e.a=i.exports},"4b8c":function(t,e,s){"use strict";s.r(e);var a=s("2048"),r=s("1bab"),i={name:"userlist",data(){this.$createElement;return{isSearchUser:!1,loading:!1,pageNum:1,pageSize:20,total:0,updateUserInfoMSG:!1,grouplist:[],queryText:null,formItem:{},columns:[{type:"selection",width:55,align:"center"},{type:"expand",width:45,render:(t,e)=>t(a.a,{props:{row:e.row}})},{title:"用户名",minWidth:200,key:"username"},{title:"邮箱",minWidth:200,key:"email"},{title:"状态",minWidth:90,align:"center",render:(t,e)=>1==e.row.isok?t("Icon",{attrs:{type:"md-checkmark-circle",title:"可用",size:"20",color:"rgb(73 156 84 / 70%)"}}):t("Icon",{attrs:{type:"md-close-circle",title:"不可用",size:"20",color:"rgb(252 85 49 / 70%)"}})},{title:"操作",width:120,key:"action",slot:"action"}],userList:[],userIdList:[]}},mounted(){this.getUserList(),this.getStorage()},methods:{getStorage(){Object(r.a)("/admin/root/getGrouplistForUsers",{}).then(t=>{200==t.status&&(this.grouplist=t.data.data)}).catch(t=>{console.log(t),this.$Message.error("服务器请求错误")})},handleSelectAll(t){this.$refs.selection.selectAll(t)},toPageIndex(t){this.pageNum=t,this.getUserList()},toPageSize(t){console.log(t)},getUserList(){this.loading=!0;var t={};t.pageNum=this.pageNum,t.pageSize=this.pageSize,null!=this.queryText&&""!=this.queryText?t.queryText=this.queryText:t.queryText=null,Object(r.a)("/admin/root/getUserList",t).then(t=>{if(this.isSearchUser=!1,200==t.status){var e=t.data.data.list;this.total=t.data.count,e.length>0&&(this.userList=e)}else this.$Message.error("请求时出现错误");this.loading=!1}).catch(t=>{this.loading=!1,console.log(t),this.$Message.error("服务器请求错误")})},toQuery(){if(null==this.queryText||""==this.queryText.replace(/\s*/g,""))return!1;this.pageNum=1,this.pageSize=20,this.userList=[],this.getUserList()},delQuery(){this.queryText=null,this.pageNum=1,this.pageSize=20,this.getUserList()},showSeach(){this.isSearchUser=!0},selectuser(t){if(t.length>0)for(let e=0;e<t.length;e++)this.userIdList.push(t[e].id);else this.userIdList=[]},showUserInfo(t){this.formItem={},this.updateUserInfoMSG=!0,this.formItem=t,this.formItem.memory=parseInt(this.formItem.memory)},deleUser(t){this.$Modal.confirm({title:"确认删除",content:"<p>您确认删除所选用户吗</p>",onOk:()=>{this.sendDeleUser(t)},onCancel:()=>{}})},deleSelectUser(){0!=this.userIdList.length?this.$Modal.confirm({title:"确认删除",content:"<p>您确认删除所选用户吗</p>",onOk:()=>{this.sendDeleUser()},onCancel:()=>{}}):this.$Message.warning("请选择要操作的数据")},disableSelectUser(){0!=this.userIdList.length?this.$Modal.confirm({title:"用户冻结",content:"<p>您确认冻结所选用户吗</p>",onOk:()=>{this.senddisableUser()},onCancel:()=>{}}):this.$Message.warning("请选择要操作的数据")},sendDeleUser(t){this.loading=!0;var e={};if(null==t){if(0==this.userIdList.length)return this.$Message.warning("所选数据丢失，不可操作"),!1}else this.userIdList=[],this.userIdList.push(t);e.arr=this.userIdList,Object(r.a)("/admin/root/deleUser",e).then(t=>{200==t.status?("200"==t.data.code?(this.userIdList=[],this.$Message.success(t.data.info)):this.$Message.warning(t.data.info),this.userList=[],this.getUserList()):this.$Message.error("请求时出现错误"),this.loading=!1}).catch(t=>{this.loading=!1,console.log(t),this.$Message.error("服务器请求错误")})},senddisableUser(){this.loading=!0;var t={};if(0==this.userIdList.length)return this.$Message.warning("所选数据丢失，不可操作"),!1;t.arr=this.userIdList,Object(r.a)("/admin/root/disableUser",t).then(t=>{200==t.status?("200"==t.data.code?(this.userIdList=[],this.$Message.success(t.data.info)):this.$Message.warning(t.data.info),this.userList=[],this.getUserList()):this.$Message.error("请求时出现错误"),this.loading=!1}).catch(t=>{this.loading=!1,console.log(t),this.$Message.error("服务器请求错误")})},updateUserInfo(){var t;""!=this.formItem.id&&""!=this.formItem.email&&""!=this.formItem.memory&&""!=this.formItem.groupid&&""!=this.formItem.isOkSwitch?Number(this.formItem.memory)>1048576?this.$Message.warning("容量不得超过1048576"):(t=this.formItem,Object(r.a)("/admin/root/updateUserInfo",t).then(t=>{200==t.status?("200"==t.data.code?this.$Message.success(t.data.info):this.$Message.warning(t.data.info),this.updateUserInfoMSG=!1,this.getUserList()):this.$Message.error("请求时出现错误")}).catch(t=>{console.log(t),this.$Message.error("服务器请求错误")})):this.$Message.warning("各参数不能为空")}},computed:{isOkSwitch:{get(){return 1==this.formItem.isok},set(t){this.formItem.isok=t?1:-1}}}},o=(s("bd54"),s("2877")),n=Object(o.a)(i,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("Layout",{staticStyle:{"margin-top":"50px","margin-bottom":"50px"}},[s("Content",{style:{margin:"15px 20px 0"}},[s("p",{staticStyle:{position:"fixed",right:"58px","z-index":"1",bottom:"68px"}},[s("Button",{staticStyle:{"z-index":"1","margin-right":"8px","box-shadow":"rgba(0, 0, 0, 0.4) 0px 2px 6px 0px"},attrs:{type:"primary",shape:"circle",icon:"ios-search"},on:{click:t.showSeach}},[t._v("筛 选")]),s("Dropdown",{staticStyle:{"z-index":"1","box-shadow":"rgba(0, 0, 0, 0.4) 0px 2px 6px 0px","border-radius":"50%"},attrs:{trigger:"click"}},[s("Button",{attrs:{type:"primary",shape:"circle"}},[t._v(" 操 作 "),s("Icon",{attrs:{type:"ios-arrow-down"}})],1),s("DropdownMenu",{attrs:{slot:"list"},slot:"list"},[s("DropdownItem",{nativeOn:{click:function(e){return t.disableSelectUser.apply(null,arguments)}}},[s("Icon",{attrs:{type:"md-close-circle"}}),t._v(" 禁用选中")],1),s("DropdownItem",{nativeOn:{click:function(e){return t.deleSelectUser.apply(null,arguments)}}},[s("Icon",{attrs:{type:"md-trash"}}),t._v(" 删除选中")],1)],1)],1)],1),s("Card",{staticClass:"cardShadow",staticStyle:{"margin-top":"10px","padding-left":"8px","padding-right":"8px"}},[s("Table",{ref:"selection",attrs:{loading:t.loading,columns:t.columns,data:t.userList},on:{"on-selection-change":t.selectuser},scopedSlots:t._u([{key:"action",fn:function(e){var a=e.row,r=e.index;return[s("div",{staticStyle:{"max-width":"200px"}},[s("Icon",{key:r,attrs:{type:"md-settings tablebut"},on:{click:function(e){return t.showUserInfo(a)}}}),s("Icon",{attrs:{type:"md-trash tablebut"},on:{click:function(e){return t.deleUser(a.id)}}})],1)]}}])},[s("Switch",{model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}})]),s("div",{staticStyle:{"margin-top":"20px"}},[s("Page",{attrs:{total:t.total,"page-size":t.pageSize},on:{"on-change":t.toPageIndex,"on-page-size-change":t.toPageSize}})],1)],1)],1),s("Modal",{attrs:{"footer-hide":!0},model:{value:t.isSearchUser,callback:function(e){t.isSearchUser=e},expression:"isSearchUser"}},[s("br"),s("Form",{nativeOn:{submit:function(t){t.preventDefault()}}},[s("FormItem",[s("Input",{staticStyle:{width:"100%"},attrs:{prefix:"ios-contact",placeholder:"请输入用户名或邮箱",size:"large"},model:{value:t.queryText,callback:function(e){t.queryText=e},expression:"queryText"}})],1),s("FormItem",{staticStyle:{"text-align":"center"}},[s("ButtonGroup",{attrs:{shape:"circle"}},[s("Button",{attrs:{type:"error"},on:{click:t.delQuery}},[t._v(" 重置 "),s("Icon",{attrs:{type:"ios-arrow-forward"}})],1),s("Button",{attrs:{type:"primary"},on:{click:t.toQuery}},[s("Icon",{attrs:{type:"ios-search"}}),t._v(" 搜索 ")],1)],1)],1)],1)],1),s("Modal",{attrs:{"footer-hide":!0},model:{value:t.updateUserInfoMSG,callback:function(e){t.updateUserInfoMSG=e},expression:"updateUserInfoMSG"}},[s("br"),s("Form",{attrs:{"label-width":80},nativeOn:{submit:function(t){t.preventDefault()}}},[s("FormItem",{attrs:{label:"用户邮箱"}},[s("Input",{attrs:{placeholder:"用户邮箱",maxlength:"100","show-word-limit":"",size:"large"},model:{value:t.formItem.email,callback:function(e){t.$set(t.formItem,"email",e)},expression:"formItem.email"}})],1),s("FormItem",{attrs:{label:"可用容量"}},[s("Input",{attrs:{type:"number",placeholder:"可用容量",size:"large"},model:{value:t.formItem.memory,callback:function(e){t.$set(t.formItem,"memory",e)},expression:"formItem.memory"}},[s("span",{attrs:{slot:"append"},slot:"append"},[t._v("M")])])],1),s("FormItem",{attrs:{label:"分发群组"}},[s("Select",{attrs:{filterable:"",placeholder:"存储源",size:"large"},model:{value:t.formItem.groupid,callback:function(e){t.$set(t.formItem,"groupid",e)},expression:"formItem.groupid"}},t._l(t.grouplist,(function(e){return s("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.groupname))])})),1)],1),s("FormItem",{attrs:{label:"可用性"}},[s("i-switch",{attrs:{size:"large"},model:{value:t.isOkSwitch,callback:function(e){t.isOkSwitch=e},expression:"isOkSwitch"}},[s("span",{attrs:{slot:"1"},slot:"1"},[t._v("开启")]),s("span",{attrs:{slot:"0"},slot:"0"},[t._v("关闭")])])],1),s("p",{staticStyle:{"text-align":"center",color:"#f56838"}},[t._v("注意：欲要给用户分配分发群组，只能选择未指定用户组的分发群组")]),s("br"),s("Button",{attrs:{type:"primary",icon:"md-done-all",long:"",shape:"circle"},on:{click:t.updateUserInfo}},[t._v("保 存")])],1)],1),s("Footer",{staticClass:"layout-footer-center"},[t._v(t._s(this.$store.state.metaInfo.webname)+" © Control Panel")])],1)}),[],!1,null,null,null);e.default=n.exports},7130:function(t,e,s){"use strict";s("05fb")},"99c5":function(t,e,s){},bd54:function(t,e,s){"use strict";s("99c5")}}]);