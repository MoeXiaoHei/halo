(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-25b3c292"],{1:function(t,e){},"1bab":function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));i("8237");var a=i("2b0e"),s=i("4328"),l=i.n(s);function n(t,e,i){return new Promise((s,n)=>{let o={data:JSON.stringify(e)};var r="60000";null!=i&&(r=i+"");let c=parseInt(r);t=t+"?"+(new Date).getTime()+Math.random()+Math.ceil(-89999*Math.random()+99999),a.default.prototype.$http.post(t,l.a.stringify(o),{timeout:c}).then(t=>{s(t)}).catch(t=>{n(t)})})}},"655b":function(t,e,i){},"6d14":function(t,e,i){"use strict";i.r(e);var a=i("1bab"),s={name:"gallery",components:{albumList:i("f3ac").a},data:()=>({loading:!0,pageNum:1,pageSize:10,total:0,GalleryList:[],albumkeyList:[],albumlist:[],spinShow:!0,visible:!1,columns:[{type:"selection",width:55,align:"center"},{title:"画廊标题",minWidth:200,key:"albumtitle"},{title:"画廊地址",minWidth:300,render:(t,e)=>t("a",{attrs:{name:e.row.albumkey,target:"_blank",href:window.location.protocol+"//"+window.location.host+"/h/"+e.row.albumkey}},window.location.protocol+"//"+window.location.host+"/h/"+e.row.albumkey)},{title:"创建日期",tooltip:!0,minWidth:130,align:"center",key:"createdate"},{title:"创建人",minWidth:130,align:"center",render:(t,e)=>0==e.row.userid?t("span",{},"访客"):t("span",{},e.row.username)},{title:"访问密码",align:"center",width:100,render:(t,e)=>e.row.password?t("span",{},e.row.password):t("span",{},"无")},{title:"操作",width:120,key:"action",slot:"action"}],groupList:[]}),mounted(){this.$Spin.show(),this.getGalleryList(),this.$Spin.hide()},methods:{toPageIndex(t){this.pageNum=t,this.getGalleryList()},toPageSize(t){},getGalleryList(){var t={};t.pageNum=this.pageNum,t.pageSize=this.pageSize,Object(a.a)("/admin/getGalleryList",t).then(t=>{200==t.status&&(this.loading=!1,this.GalleryList=t.data.data.list,this.total=t.data.count)}).catch(t=>{console.log(t),this.$Message.error("服务器请求错误")})},selectGallery(t){if(t.length>0)for(let e=0;e<t.length;e++)this.albumkeyList.push(t[e].albumkey);else this.albumkeyList=[]},deleSelectGallery(){0!=this.albumkeyList.length?this.$Modal.confirm({title:"确认删除",content:"<p>您确认删除所选画廊吗</p>",onOk:()=>{this.sendDeleGallery()},onCancel:()=>{}}):this.$Message.warning("请先选择要操作的数据")},upGallery(t){this.albumlist=[],this.getAlbumListForKey(t),this.visible=!0},getAlbumListForKey(t){var e={key:t};Object(a.a)("/admin/getAlbumListForKey",e).then(e=>{if(this.$Spin.hide(),200==e.status){var i=e.data.data;this.albumlist=i.imagesList,this.$refs.album.getTilePass(i.album.albumtitle,i.album.password,t,this.albumlist),this.spinShow=!1}else this.$Message.error("请求时出现错误")}).catch(t=>{this.$Spin.hide(),console.log(t),this.$Message.error("服务器请求错误")})},deleGallery(t){this.$Modal.confirm({title:"确认删除",content:"<p>您确认删除所选画廊吗</p>",onOk:()=>{this.sendDeleGallery(t)},onCancel:()=>{}})},sendDeleGallery(t){this.loading=!0;var e={};if(null!=t&&""!=t){let i=[];i.push(t),e.albumkeyList=i}else{if(0==this.albumkeyList.length)return this.loading=!1,this.$Message.warning("请先选择要操作的数据"),!1;e.albumkeyList=this.albumkeyList}Object(a.a)("/admin/deleGallery",e).then(t=>{console.log(t),200==t.status?("200"==t.data.code?this.$Message.success(t.data.info):this.$Message.warning(t.data.info),this.getGalleryList()):this.$Message.error("请求时出现错误"),this.loading=!1}).catch(t=>{this.loading=!1,console.log(t),this.$Message.error("服务器请求错误")})},returnData(t){this.visible=!1}}},l=(i("fc7f"),i("2877")),n=Object(l.a)(s,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("Layout",{staticStyle:{"margin-top":"50px","margin-bottom":"50px"}},[i("Content",{style:{margin:"15px 20px 0"}},[i("p",{staticStyle:{position:"fixed",right:"58px","z-index":"1",bottom:"68px"}},[i("Button",{staticStyle:{"z-index":"1","margin-right":"8px","box-shadow":"rgba(0, 0, 0, 0.4) 0px 2px 6px 0px"},attrs:{type:"primary",shape:"circle",icon:"md-trash"},on:{click:t.deleSelectGallery}},[t._v("删除选中")])],1),i("Card",{staticClass:"cardShadow",staticStyle:{"margin-top":"10px","padding-left":"8px","padding-right":"8px"}},[i("Table",{ref:"selection",attrs:{loading:t.loading,columns:t.columns,data:t.GalleryList},on:{"on-selection-change":t.selectGallery},scopedSlots:t._u([{key:"action",fn:function(e){var a=e.row,s=e.index;return[i("Icon",{attrs:{title:"编辑",type:"md-reverse-camera tablebut"},on:{click:function(e){return t.upGallery(a.albumkey)}}}),i("Icon",{attrs:{title:"删除",type:"md-trash tablebut",value:s},on:{click:function(e){return t.deleGallery(a.albumkey)}}})]}}])},[i("Switch",{model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}})]),i("div",{staticStyle:{"margin-top":"20px"}},[i("Page",{attrs:{total:t.total,"page-size":t.pageSize},on:{"on-change":t.toPageIndex,"on-page-size-change":t.toPageSize}})],1)],1)],1),i("Footer",{staticClass:"layout-footer-center"},[t._v(t._s(this.$store.state.metaInfo.webname)+" © Control Panel")]),i("Modal",{attrs:{"footer-hide":!0,width:"620"},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[i("div",{staticStyle:{padding:"30px 5px"}},[t.spinShow?i("Spin",{attrs:{size:"large",fix:""}}):t._e(),i("album-list",{ref:"album",attrs:{albumlist:t.albumlist,ischange:!0},on:{"return-data":t.returnData}})],1)])],1)}),[],!1,null,null,null);e.default=n.exports},"951d":function(t,e,i){"use strict";i("c882")},c882:function(t,e,i){},f3ac:function(t,e,i){"use strict";var a=i("1bab"),s={name:"album-list",props:{albumlist:{type:Array,require:!0},ischange:{type:Boolean,default:()=>!1,require:!1}},data:()=>({showDrawer:!1,aloading:!1,BrowseImages:[],thisAlbumlist:[],newAlbumlist:[],albumtitle:null,password:null,pageNum:1,pageSize:30,isMyImages:!1,imglist:[],btntext:"加载更多",noImgMsg:!1,nextButloading:!1,selectImage:[],operatState:"update",newAlbumArr:[],albumkey:null}),mounted(){},methods:{getTilePass(t,e,i,a){this.albumkey=i,this.thisAlbumlist=a,this.BrowseImages=a,null!=t&&""!=t&&(this.albumtitle=t,this.password=e)},submitAlbum(){if(null==this.albumtitle||""==this.albumtitle)return this.$Message.warning("画廊标题不能为空"),!1;if(0==this.albumlist.length)return this.$Message.warning("画廊图像不存在"),!1;this.aloading=!0;var t={albumtitle:this.albumtitle,password:this.password,albumlist:this.albumlist};Object(a.a)("/SaveForAlbum",t).then(t=>{if(this.$Spin.hide(),200==t.status){this.aloading=!1;var e=t.data.data;"200"==t.data.code?this.$emit("return-data",e):this.$Message.error(t.data.info)}else this.$Message.error("请求时出现错误")}).catch(t=>{this.$Spin.hide(),console.log(t),this.$Message.error("服务器请求错误")})},submitUpdateAlbum(){this.aloading=!0;var t={};null!=this.albumtitle&&""!=this.albumtitle?0!=this.thisAlbumlist.length?(t.albumkey=this.albumkey,t.albumtitle=this.albumtitle,t.password=this.password,t.albumlist=this.thisAlbumlist,Object(a.a)("/admin/UpdateForAlbum",t).then(t=>{if(this.$Spin.hide(),200==t.status){this.aloading=!1;var e=t.data.data;"200"==t.data.code?(this.$Message.success(t.data.info),this.$emit("return-data",e)):this.$Message.error(t.data.info)}else this.$Message.error("请求时出现错误")}).catch(t=>{this.$Spin.hide(),console.log(t),this.$Message.error("服务器请求错误")})):this.$Message.warning("画廊未检出到图像"):this.$Message.warning("画廊标题不能为空")},updateImg(){this.isMyImages=!0,this.selectImage=[];for(let t=0;t<this.thisAlbumlist.length;t++)this.selectImage.push(this.thisAlbumlist[t].id);this.selectPhoto()},selectPhoto(){var t={};t.pageNum=this.pageNum,t.pageSize=this.pageSize,t.selectUserType="me",t.selecttype=null,t.username=null,t.violation=!1,this.nextButloading=!0,Object(a.a)("/admin/selectPhoto",t).then(t=>{if(200==t.status)if("200"==t.data.code){var e=t.data.data.rows;e.length>0?(this.imglist=this.imglist.concat(e),this.pageNum++,this.nextButloading=!1,this.imglist.length<this.pageSize?this.btntext="所有数据加载完毕":this.btntext="加载更多"):this.btntext="所有数据加载完毕",0==this.imglist.length&&(this.noImgMsg=!0)}else this.$Message.warning(t.data.info);else this.$Message.error("请求时出现错误")}).catch(t=>{console.log(t),this.$Message.error("服务器请求错误")})},selectImageClick(t){-1==this.selectImage.indexOf(this.imglist[t].id)&&this.selectImage.push(this.imglist[t].id),this.BrowseImages.push(this.imglist[t])},noSelectImageClick(t){this.selectImage.splice(this.selectImage.indexOf(t),1);for(let e=0;e<this.BrowseImages.length;e++)if(t==this.BrowseImages[e].id){this.BrowseImages.splice(e,1);break}},saveNewAlbumlist(){this.isMyImages=!1},toShowDrawer(){this.showDrawer=!0},delBrowseImages(t,e){var i=this;i.BrowseImages.splice(e,1),i.selectImage.forEach((e,a)=>{t==e&&i.selectImage.splice(a,1)})}}},l=(i("951d"),i("2877")),n=Object(l.a)(s,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticStyle:{height:"510px"}},[i("div",{staticStyle:{margin:"0 auto",height:"500px","overflow-x":"hidden","overflow-y":"auto"}},[i("Divider",[t._v("画廊信息")]),i("Row",[i("Col",{attrs:{xs:24,sm:24,md:12,lg:12}},[i("Input",{staticStyle:{width:"266px",margin:"auto"},attrs:{maxlength:"30"},model:{value:t.albumtitle,callback:function(e){t.albumtitle=e},expression:"albumtitle"}},[i("span",{attrs:{slot:"prepend",placeholder:"画廊标题"},slot:"prepend"},[t._v("标题")])])],1),i("Col",{attrs:{xs:24,sm:24,md:12,lg:12}},[i("Input",{staticStyle:{width:"266px",margin:"auto"},attrs:{maxlength:"30"},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}},[i("span",{attrs:{slot:"prepend",placeholder:"可留空"},slot:"prepend"},[t._v("密码")])])],1)],1),i("Row",[t.ischange?i("div",{staticStyle:{height:"40px",width:"95%",margin:"auto","text-align":"center","line-height":"50px","margin-top":"10px"}},[i("Button",{attrs:{type:"primary",long:""},on:{click:t.updateImg}},[t._v("增删图片")])],1):t._e()]),i("Divider",[t._v("图片列表")]),t._l(t.ischange?t.thisAlbumlist:t.albumlist,(function(e,a){return i("List",{key:a,staticStyle:{"max-height":"60vh",overflow:"auto"}},[i("ListItem",[i("div",{staticStyle:{width:"100%",padding:"0 10px","min-width":"295px"}},[i("Row",[i("Col",{attrs:{flex:"83px"}},[i("div",{staticStyle:{width:"100%","text-align":"center"}},[i("img",{staticStyle:{height:"70px","max-width":"80px","object-fit":"cover","border-radius":"5px"},attrs:{src:e.imgurl}})])]),i("Col",{attrs:{flex:"auto"}},[i("Input",{attrs:{type:"textarea",rows:3,maxlength:"500",placeholder:"图片说明/描述,可留空"},model:{value:e.notes,callback:function(i){t.$set(e,"notes",i)},expression:"album.notes"}})],1)],1)],1)])],1)}))],2),t.ischange?i("div",{staticClass:"example-code-more",staticStyle:{height:"49px"}},[i("Button",{staticStyle:{position:"absolute",bottom:"10px",right:"10px"},attrs:{type:"primary",loading:t.aloading},nativeOn:{click:function(e){return t.submitUpdateAlbum.apply(null,arguments)}}},[t._v("更新")])],1):i("div",{staticClass:"example-code-more",staticStyle:{height:"49px"}},[i("Button",{staticStyle:{position:"absolute",bottom:"10px",right:"10px"},attrs:{type:"primary",loading:t.aloading},nativeOn:{click:function(e){return t.submitAlbum.apply(null,arguments)}}},[t._v("保存")])],1),i("Modal",{attrs:{"footer-hide":!0,width:"800"},model:{value:t.isMyImages,callback:function(e){t.isMyImages=e},expression:"isMyImages"}},[i("div",{staticStyle:{width:"84%",height:"30px",margin:"0 auto",cursor:"pointer","text-align":"center","line-height":"30px","box-shadow":"0 1px 6px 0 rgba(32, 33, 36,.28)","border-radius":"5px"},on:{click:t.toShowDrawer}},[t._v(" 已选图像"),i("Icon",{attrs:{type:"ios-arrow-dropdown",size:"16"}})],1),i("Drawer",{attrs:{inner:!0,transfer:!1,title:"已选图像",placement:"top",closable:!1},model:{value:t.showDrawer,callback:function(e){t.showDrawer=e},expression:"showDrawer"}},[i("div",{staticStyle:{width:"100%"}},t._l(t.BrowseImages,(function(e,a){return i("ul",{key:a,attrs:{id:"menu"}},[i("li",[i("div",{staticStyle:{width:"64px",height:"64px",position:"relative",padding:"2px"}},[i("Icon",{staticStyle:{position:"absolute","z-index":"1",right:"-7px",top:"-4px",cursor:"pointer"},attrs:{type:"md-close-circle"},on:{click:function(i){return t.delBrowseImages(e.id,a)}}}),i("img",{staticClass:"imgstyle-toolbar_exp imgstyle",staticStyle:{cursor:"pointer"},attrs:{src:e.imgurl}})],1)])])})),0)]),i("Content",{staticStyle:{"overflow-y":"auto",height:"500px"},style:{margin:"15px 5px 0"}},[i("viewer",[i("Row",{staticClass:"animate__animated animate__fadeIn animate__delay-1.5s"},t._l(t.imglist,(function(e,a){return i("Col",{key:a,attrs:{flex:"1"}},[i("div",{staticClass:"imgdivstyle_exp divimgstyle-min_exp"},[i("span",{directives:[{name:"show",rawName:"v-show",value:t.selectImage.indexOf(e.id)>-1,expression:"selectImage.indexOf(item.id)>-1"}],staticClass:"formatTag_exp",on:{click:function(i){return t.noSelectImageClick(e.id)}}},[i("Icon",{staticStyle:{"margin-top":"50px"},attrs:{type:"md-done-all",size:"50"}})],1),i("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.imgurl+"",expression:"item.imgurl+''"}],key:e.imgurl,staticClass:"imgstyle-min_exp imgstyle",attrs:{src:e.imgurl+""},on:{click:function(e){return t.selectImageClick(a)}}})])])})),1),i("div",{directives:[{name:"show",rawName:"v-show",value:t.noImgMsg,expression:"noImgMsg"}],staticStyle:{width:"100%","text-align":"center",color:"#797b7f"}},[i("Icon",{attrs:{type:"ios-filing",size:"56"}}),i("p",[t._v("当前未找到任何图像")])],1)],1),i("div",{staticClass:"example-code-more"},[i("Button",{attrs:{type:"dashed",loading:t.nextButloading,disabled:"所有数据加载完毕"==t.btntext,long:""},on:{click:t.selectPhoto}},[t._v(t._s(t.btntext))])],1)],1),i("div",{staticClass:"example-code-more"},[i("Button",{staticStyle:{position:"absolute",bottom:"10px",right:"10px"},attrs:{type:"primary"},on:{click:t.saveNewAlbumlist}},[t._v("确定")])],1)],1)],1)}),[],!1,null,null,null);e.a=n.exports},fc7f:function(t,e,i){"use strict";i("655b")}}]);